Datamodel versions
==================

All files generated by the datamodel package are in FITS format, and include a
DAMD_VER header keyword. The value is an integer that should be incremented
every time there is a format change for that particular type of file; this makes
maintaining backward compatibility easier. Below we list format changes for each
class in the datamodel package, and the corresponding value of the DAMD_VER
header keyword.


PfsDesign and PfsConfig
-----------------------

These are used for the pfsDesign and pfsConfig products.

These two classes are strongly related, reflected in PfsConfig inheriting from
PfsDesign, and so their versions are incremented together.

* 1: Initial version.
* 2: Additional HDU added for guide star information, provided by ETS shuffle.
* 3: Write pfsDesignId and visit0 in header.


PfsDetectorMap
--------------

These classes are used for the detectorMap product. There are different formats,
supporting different kinds of detectorMap models.

Note that the DifferentialDetectorMap, DistortedDetectorMap and
DoubleDetectorMap are strongly coupled to the SplinedDetectorMap, so their
versions are incremented together.


SplinedDetectorMap, DifferentialDetectorMap, DistortedDetectorMap and
DoubleDetectorMap:
* 1: Initial version.
* 2: MODEL_FIBERID extension for DifferentialDetectorMap removed.


PfsSimpleSpectrum and PfsFiberArray
-----------------------------------

These two classes are strongly related, reflected in PfsFiberArray inheriting
from PfsSimpleSpectrum, and so their versions are incremented together.

These classes are used for the pfsReference, pfsSingle and pfsObject products.

* 1: Initial version.
* 2: Added NOTES to PfsFiberArray.


PfsFiberArraySet
----------------

This class is used for the pfsArm and pfsMerged products.

* 1: Initial version.
* 2: Added NORM for normalisations.
* 3: Added NOTES to PfsFiberArraySet.
* 4: Allow WAVELENGTH to be a single array if it applies to all spectra.


PfsTargetSpectra
----------------

This class is used for the pfsCalibrated and pfsCoadd products.

* 1: Initial version.


PfsFiberProfiles
----------------

This class is used for the pfsFiberProfiles product.

* 1: Initial version.
* 2: Write identity in header.


PfsFiberTrace
-------------

This class was used for the old pfsFiberTrace product (replaced by
pfsFiberProfiles).

* 1: Initial version.


FluxTable
---------

This is written as a FITS table inside other products.

* 1: Initial version.


Identity and CalibIdentity
--------------------------

These are written as a FITS table inside other products.

* 1: Initial version.


Observations
------------

This is written as a FITS table inside other products.

* 1: Initial version.
* 2: Added obsTime, expTime.


Target
------

This is written as a FITS table inside other products.

* 1: Initial version.


MaskHelper
----------

This is written to the FITS header only, and so this class is not versioned
independently. Changes to this class should be reflected in incremented versions
for all classes that use it.


GuideStars
---------

This is written as a FITS table inside other products.

* 1: Initial version.


PfsTable
--------

This class (and subclasses) is used for the arcLines product.

* 1: Initial version.
* 2: arcLines changed intensity->flux, intensityErr->fluxErr.


PfsFocalPlaneFunction
---------------------

This class (and subclasses) are used for the sky1d, sky2d, fluxCal and apCorr
products.

* <no DAMD_VER header keyword>: written before I/O moved to datamodel package.
* 1: Initial version in datamodel package. Class names were prepended with "Pfs".


PfsFiberNorms
-------------

This class is used for the fiber normalisations calib product.

* 1: Initial version in datamodel package.
* 2: Major format changes.


ObjectGroupMap
--------------

This class is used for determining the objGroup from catId,objId.

* 1: Initial version.
